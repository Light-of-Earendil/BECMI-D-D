// ==========================================================================
// Mixins - Reusable Interaction Element Styles
// ==========================================================================
//
// This file contains mixins for common interaction elements:
// - Buttons (base, variants, sizes, states)
// - Links (base, hover effects, focus)
// - Inputs (text, number, email, password)
// - Textareas
// - Selects
// - Form states (disabled, readonly, error, success)
// - Focus rings
//
// Usage Example:
//   .my-button
//     button-base()
//     button-variant(linear-gradient(180deg, #f0e7cd, #d7c796), #2a1409)
//     button-size-lg()
//
//   .my-input
//     input-base()
//     input-contrast()
//
// ==========================================================================

// ==========================================================================
// Button Mixins
// ==========================================================================

// Base button styles
button-base()
  display: inline-flex
  align-items: center
  justify-content: center
  gap: var(--space-2)
  padding: 10px 16px
  border-radius: 999px
  border: 1px solid rgba(0,0,0,0.25)
  box-shadow: 0 2px 0 rgba(0,0,0,0.55), inset 0 1px 0 rgba(255,255,255,0.65)
  cursor: pointer
  transition: transform var(--t-fast) var(--ease), box-shadow var(--t-fast) var(--ease), background var(--t-med) var(--ease)
  text-decoration: none
  user-select: none
  font-weight: 500
  font-size: 1rem
  font-family: 'Lora', Georgia, 'Times New Roman', serif

// Button variant (background and foreground colors)
button-variant(bg, fg = var(--wood-900))
  background: bg
  color: fg

// Button hover state
button-hover()
  transform: translateY(-1px)
  box-shadow: 0 3px 0 rgba(0,0,0,0.55), inset 0 1px 0 rgba(255,255,255,0.65)

// Button active state
button-active()
  transform: translateY(0)
  box-shadow: 0 1px 0 rgba(0,0,0,0.65), inset 0 2px 0 rgba(0,0,0,0.15)

// Button focus state
button-focus(ring = var(--brass-300))
  outline: 3px solid ring
  outline-offset: 2px

// Button disabled state
button-disabled()
  opacity: 0.6
  cursor: not-allowed
  box-shadow: 0 1px 0 rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.3)
  
  &:hover
    transform: none

// Button size variants
button-size-sm()
  padding: 6px 12px
  font-size: 0.875rem

button-size-lg()
  padding: 14px 24px
  font-size: 1.125rem

// ==========================================================================
// Link Mixins
// ==========================================================================

// Base link styles
link-base(color = var(--brass-300))
  background: none
  border: none
  color: color
  cursor: pointer
  text-decoration: none
  padding: 0
  font-size: 0.875rem
  font-family: 'Lora', Georgia, 'Times New Roman', serif
  transition: color var(--t-fast) var(--ease)
  display: inline-block
  position: relative

// Link hover effect with underline
link-hover-underline(color = var(--brass-300))
  &:hover
    color: var(--brass-400)
    text-decoration: none
    
    &::after
      width: 100%
  
  &::after
    content: ""
    position: absolute
    bottom: -2px
    left: 0
    width: 0
    height: 1px
    background: color
    transition: width var(--t-fast) var(--ease)

// Link focus state
link-focus(ring = var(--brass-300))
  outline: 2px solid ring
  outline-offset: 2px
  border-radius: 2px

// ==========================================================================
// Input Mixins
// ==========================================================================

// Base input styles (text, number, email, password)
input-base()
  width: 100%
  padding: 10px 12px
  border-radius: 10px
  border: 1px solid rgba(0,0,0,0.35)
  background: linear-gradient(180deg, var(--parchment-100), var(--parchment-300))
  color: var(--wood-900)
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.6), inset 0 -1px 0 rgba(0,0,0,0.25)
  transition: border-color var(--t-fast) var(--ease), box-shadow var(--t-fast) var(--ease)
  font-family: 'Lora', Georgia, 'Times New Roman', serif
  font-size: 1rem

// Input with better contrast (for text, number, email, password)
input-contrast()
  color: var(--wood-900) !important
  background: linear-gradient(180deg, var(--parchment-100), var(--parchment-200)) !important
  border: 2px solid var(--wood-600) !important

// Input focus state
input-focus(ring = var(--brass-300))
  outline: none
  border-color: ring
  box-shadow: 0 0 0 3px rgba(202, 162, 74, 0.35), inset 0 1px 0 rgba(255,255,255,0.7)

// Input focus with contrast
input-focus-contrast(ring = var(--brass-500))
  color: var(--wood-900) !important
  background: linear-gradient(180deg, var(--parchment-100), var(--parchment-300)) !important
  border-color: ring !important

// Input placeholder
input-placeholder()
  color: var(--wood-700)
  opacity: 0.7

// ==========================================================================
// Textarea Mixins
// ==========================================================================

// Base textarea styles
textarea-base()
  width: 100%
  padding: 10px 12px
  border-radius: 10px
  border: 1px solid rgba(0,0,0,0.35)
  background: linear-gradient(180deg, var(--parchment-100), var(--parchment-300))
  color: var(--wood-900)
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.6), inset 0 -1px 0 rgba(0,0,0,0.25)
  transition: border-color var(--t-fast) var(--ease), box-shadow var(--t-fast) var(--ease)
  font-family: 'Lora', Georgia, 'Times New Roman', serif
  font-size: 1rem
  resize: vertical
  min-height: 100px

// Textarea focus state
textarea-focus(ring = var(--brass-300))
  outline: none
  border-color: ring
  box-shadow: 0 0 0 3px rgba(202, 162, 74, 0.35), inset 0 1px 0 rgba(255,255,255,0.7)

// ==========================================================================
// Select Mixins
// ==========================================================================

// Base select styles
select-base()
  width: 100%
  padding: 10px 12px
  border-radius: 10px
  border: 1px solid rgba(0,0,0,0.35)
  background: linear-gradient(180deg, var(--parchment-100), var(--parchment-300))
  color: var(--wood-900)
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.6), inset 0 -1px 0 rgba(0,0,0,0.25)
  transition: border-color var(--t-fast) var(--ease), box-shadow var(--t-fast) var(--ease)
  font-family: 'Lora', Georgia, 'Times New Roman', serif
  font-size: 1rem
  cursor: pointer
  appearance: none
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%232a1409' d='M6 9L1 4h10z'/%3E%3C/svg%3E")
  background-repeat: no-repeat
  background-position: right 12px center
  padding-right: 36px

// Select focus state
select-focus(ring = var(--brass-300))
  outline: none
  border-color: ring
  box-shadow: 0 0 0 3px rgba(202, 162, 74, 0.35), inset 0 1px 0 rgba(255,255,255,0.7)

// ==========================================================================
// Focus Ring Utility
// ==========================================================================

// Universal focus ring for accessibility
focus-ring(ring = var(--brass-300), offset = 2px)
  outline: 3px solid ring
  outline-offset: offset

// ==========================================================================
// Form Element States
// ==========================================================================

// Disabled state for form elements
form-disabled()
  opacity: 0.6
  cursor: not-allowed
  pointer-events: none

// Read-only state
form-readonly()
  background: linear-gradient(180deg, var(--parchment-200), var(--parchment-300)) !important
  cursor: default

// Error state
form-error()
  border-color: var(--red-500) !important
  box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.2), inset 0 1px 0 rgba(255,255,255,0.6)

// Success state
form-success()
  border-color: var(--green-crt) !important
  box-shadow: 0 0 0 3px rgba(142, 242, 126, 0.2), inset 0 1px 0 rgba(255,255,255,0.6)

// ==========================================================================
// Icon Button Mixin
// ==========================================================================

icon-button-base()
  width: 40px
  height: 40px
  min-width: 40px
  border-radius: 50%
  background: radial-gradient(circle at 35% 30%, var(--wood-200), var(--wood-500) 60%, var(--wood-700))
  border: 1px solid rgba(0,0,0,0.45)
  box-shadow: var(--shadow-wood)
  display: inline-grid
  place-items: center
  color: var(--text-soft)
  cursor: pointer
  transition: transform var(--t-fast) var(--ease)
  padding: 0

  &:hover
    transform: translateY(-1px)

  &:active
    transform: translateY(0)

  &:focus-visible
    focus-ring()

// ==========================================================================
// Card Mixins - For consistent card styling
// ==========================================================================

// Dark card (wood background)
card-dark(border-width = 3px)
  background: var(--wood-700)
  border: border-width solid var(--wood-800)
  border-radius: var(--radius-lg)
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.3)

// Light card (parchment background)
card-light(border-width = 2px)
  background: var(--parchment-300)
  border: border-width solid var(--wood-600)
  border-radius: var(--radius-md)
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.1)

// ==========================================================================
// Typography Mixins
// ==========================================================================

// Base heading styles (Cinzel font, weight, color)
heading-base()
  font-family: "Cinzel", Georgia, serif
  font-weight: 600
  color: var(--text-strong)

// Heading size variants for h1-h6
heading-size(level)
  if level == 1
    font-size: 2.5rem
    line-height: 1.2
  else if level == 2
    font-size: 2rem
    line-height: 1.3
  else if level == 3
    font-size: 1.75rem
    line-height: 1.4
  else if level == 4
    font-size: 1.5rem
    line-height: 1.4
  else if level == 5
    font-size: 1.25rem
    line-height: 1.5
  else if level == 6
    font-size: 1.125rem
    line-height: 1.5

// Base paragraph styles
paragraph()
  font-family: 'Lora', Georgia, 'Times New Roman', serif
  font-size: 1rem
  line-height: 1.5
  color: var(--text-soft)
  margin: 0 0 var(--space-4) 0

// Text emphasis types (strong, em, mark, del, ins)
text-emphasis(type = 'strong')
  if type == 'strong'
    font-weight: 700
    color: var(--text-strong)
  else if type == 'em'
    font-style: italic
    color: var(--text-soft)
  else if type == 'mark'
    background: var(--brass-300)
    color: var(--wood-900)
    padding: 0 2px
  else if type == 'del'
    text-decoration: line-through
    opacity: 0.7
  else if type == 'ins'
    text-decoration: underline
    color: var(--brass-400)

// Text decorations (sub, sup, small, code, pre)
text-decoration(type = 'small')
  if type == 'sub'
    font-size: 0.75em
    vertical-align: sub
  else if type == 'sup'
    font-size: 0.75em
    vertical-align: super
  else if type == 'small'
    font-size: 0.875rem
    color: var(--text-dim)
  else if type == 'code'
    font-family: "VT323", monospace
    font-size: 0.9em
    background: var(--wood-800)
    color: var(--brass-300)
    padding: 2px 4px
    border-radius: 3px
  else if type == 'pre'
    font-family: "VT323", monospace
    font-size: 0.9rem
    background: var(--wood-800)
    color: var(--brass-300)
    padding: var(--space-3)
    border-radius: var(--radius-sm)
    overflow-x: auto
    display: block

// Blockquote styling
blockquote-base()
  margin: var(--space-4) 0
  padding: var(--space-4) var(--space-6)
  border-left: 4px solid var(--brass-500)
  background: var(--wood-800)
  border-radius: var(--radius-sm)
  font-style: italic
  color: var(--text-soft)

// Horizontal rule styling
hr-base()
  border: none
  height: 2px
  background: linear-gradient(90deg, transparent, var(--wood-600), transparent)
  margin: var(--space-6) 0

// Section heading (Cinzel font with border)
heading-section(size = 1.5rem, border-color = var(--brass-500))
  font-family: "Cinzel", Georgia, serif
  font-size: size
  font-weight: 700
  color: var(--wood-900)
  text-align: center
  border-bottom: 2px solid border-color
  padding-bottom: var(--space-2)
  margin-bottom: var(--space-4)

// Text on dark background
text-on-dark()
  color: var(--text-strong)
  text-shadow: 1px 1px 2px rgba(0,0,0,0.5)

// Text on light background
text-on-light()
  color: var(--wood-900)
  text-shadow: 0 1px 2px rgba(0,0,0,0.1)

// Value display (VT323 monospace)
value-display(size = 1.5rem, color = var(--brass-500))
  font-family: "VT323", monospace
  font-size: size
  font-weight: 700
  color: color

// ==========================================================================
// Badge/Circle Mixins
// ==========================================================================

// Circular badge
badge-circle(size, bg = var(--brass-400), border-color = var(--wood-700))
  width: size
  height: size
  border-radius: 50%
  background: bg
  border: 3px solid border-color
  display: flex
  align-items: center
  justify-content: center
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.2)
  transition: all var(--t-medium) var(--ease)

// ==========================================================================
// List Mixins
// ==========================================================================

// Base list styles (ul, ol)
list-base()
  margin: var(--space-4) 0
  padding-left: var(--space-6)
  font-family: 'Lora', Georgia, 'Times New Roman', serif

// Remove list styling
list-unstyled()
  list-style: none
  padding-left: 0
  margin: 0

// Horizontal list
list-inline()
  list-style: none
  padding: 0
  margin: 0
  display: flex
  gap: var(--space-3)
  flex-wrap: wrap

// List item styling
list-item()
  margin-bottom: var(--space-2)
  line-height: 1.6
  color: var(--text-soft)

// ==========================================================================
// Table Mixins
// ==========================================================================

// Base table styles
table-base()
  width: 100%
  border-collapse: collapse
  font-family: 'Lora', Georgia, 'Times New Roman', serif
  margin: var(--space-4) 0

// Table header (th/thead)
table-header()
  background: linear-gradient(180deg, var(--wood-600), var(--wood-800))
  color: var(--text-strong)
  font-weight: 600
  padding: var(--space-3) var(--space-4)
  text-align: left
  border-bottom: 2px solid var(--wood-900)
  text-shadow: 1px 1px 2px rgba(0,0,0,0.5)

// Table cell (td)
table-cell()
  padding: var(--space-3) var(--space-4)
  border-bottom: 1px solid var(--wood-700)
  color: var(--text-soft)

// Table row (tr)
table-row()
  &:hover
    background: rgba(202, 162, 74, 0.1)

// Alternating row colors
table-striped()
  tbody tr:nth-child(even)
    background: rgba(0,0,0,0.1)

// Bordered table variant
table-bordered()
  border: 2px solid var(--wood-700)
  
  th, td
    border: 1px solid var(--wood-600)

// ==========================================================================
// Layout Mixins
// ==========================================================================

// Grid: Auto-fit grid
grid-auto-fit(min-width = 200px, gap = var(--space-4))
  display: grid
  grid-template-columns: repeat(auto-fit, minmax(min-width, 1fr))
  gap: gap

// Grid: Fixed column grid
grid-fixed(columns, gap = var(--space-4))
  display: grid
  grid-template-columns: repeat(columns, 1fr)
  gap: gap

// Flex: Center alignment
flex-center()
  display: flex
  align-items: center
  justify-content: center

// Flex: Space-between
flex-between()
  display: flex
  align-items: center
  justify-content: space-between

// Flex: Column layout
flex-column(align = center, justify = flex-start)
  display: flex
  flex-direction: column
  align-items: align
  justify-content: justify

// Flex: Row layout
flex-row(align = center, justify = flex-start)
  display: flex
  flex-direction: row
  align-items: align
  justify-content: justify

// Flex: Wrap utility
flex-wrap()
  flex-wrap: wrap

// Container: Base container
container-base(max-width = 1280px, padding = var(--space-6))
  max-width: max-width
  margin: 0 auto
  padding: padding

// Section: Base section styling
section-base(padding = var(--space-6))
  padding: padding
  margin: var(--space-6) 0

// Article: Base article styling
article-base()
  padding: var(--space-6)
  background: var(--parchment-200)
  border-radius: var(--radius-md)
  margin: var(--space-4) 0

// Aside: Base aside styling
aside-base()
  padding: var(--space-4)
  background: var(--wood-800)
  border-radius: var(--radius-sm)
  margin: var(--space-4) 0

// ==========================================================================
// Visual Pattern Mixins
// ==========================================================================

// Shadows: Inset shadow
shadow-inset(offset = 2px, blur = 4px, opacity = 0.2)
  box-shadow: inset 0 offset blur rgba(0, 0, 0, opacity)

// Shadows: Drop shadow
shadow-drop(offset = 2px, blur = 8px, opacity = 0.3)
  box-shadow: 0 offset blur rgba(0, 0, 0, opacity)

// Shadows: Glow effect
// Note: color parameter should be a hex value (e.g., #caa24a) or RGB, not a CSS variable
// For CSS variables, use the variable directly in rgba() or convert to hex
shadow-glow(color = #caa24a, blur = 16px, opacity = 0.5)
  box-shadow: 0 0 blur rgba(color, opacity)

// Shadows: Wood shadow (uses existing variable)
shadow-wood()
  box-shadow: var(--shadow-wood)

// Gradients: Wood gradient
gradient-wood(direction = 180deg, start = var(--wood-600), end = var(--wood-800))
  background: linear-gradient(direction, start, end)

// Gradients: Parchment gradient
gradient-parchment(direction = 180deg, start = var(--parchment-200), end = var(--parchment-400))
  background: linear-gradient(direction, start, end)

// Gradients: Brass gradient
gradient-brass(direction = 180deg, start = var(--brass-300), end = var(--brass-500))
  background: linear-gradient(direction, start, end)

// Gradients: Radial gradient helper
gradient-radial(center = '50% 50%', colors...)
  background: radial-gradient(circle at center, colors)

// Borders: Wood border
border-wood(width = 2px, color = var(--wood-700))
  border: width solid color

// Borders: Brass border
border-brass(width = 2px, color = var(--brass-500))
  border: width solid color

// Borders: Parchment border
border-parchment(width = 1px, color = var(--parchment-600))
  border: width solid color

// Bevels: Inset bevel effect
bevel-inset()
  box-shadow: inset 0 2px 0 var(--bevel-light), inset 0 -2px 0 rgba(0,0,0,0.55)

// Bevels: Outset bevel effect
bevel-outset()
  box-shadow: 0 2px 0 var(--bevel-light), 0 -2px 0 rgba(0,0,0,0.55)

// Text Shadows: Soft text shadow
text-shadow-soft()
  text-shadow: 0 1px 2px rgba(0,0,0,0.1)

// Text Shadows: Strong text shadow
text-shadow-strong()
  text-shadow: 1px 1px 2px rgba(0,0,0,0.5)

// Text Shadows: Glowing text shadow
// Note: color parameter should be a hex value (e.g., #caa24a) or RGB, not a CSS variable
text-shadow-glow(color = #caa24a)
  text-shadow: 0 0 8px rgba(color, 0.4)

// ==========================================================================
// Animation & Transition Mixins
// ==========================================================================

// Animations: Slide in animation
animation-slide-in(duration = 0.5s, delay = 0s)
  animation: slide-in duration var(--ease) delay

// Animations: Fade animation
animation-fade(duration = 0.3s, delay = 0s)
  animation: fade duration var(--ease) delay

// Animations: Spin animation
animation-spin(duration = 2s)
  animation: spin duration linear infinite

// Animations: Pulse animation
animation-pulse(duration = 2s)
  animation: pulse duration var(--ease) infinite

// Transitions: All properties
transition-all(duration = var(--t-fast), easing = var(--ease))
  transition: all duration easing

// Transitions: Transform only
transition-transform(duration = var(--t-fast), easing = var(--ease))
  transition: transform duration easing

// Transitions: Color only
transition-color(duration = var(--t-fast), easing = var(--ease))
  transition: color duration easing

// Transitions: Opacity only
transition-opacity(duration = var(--t-fast), easing = var(--ease))
  transition: opacity duration easing

// ==========================================================================
// Component Mixins
// ==========================================================================

// Cards & Panels: Panel with wood frame
panel-base()
  background: linear-gradient(180deg, var(--wood-600), var(--wood-800))
  border-radius: var(--radius-md)
  box-shadow: var(--shadow-wood)
  padding: var(--space-4)
  position: relative

  &::before
    content: ""
    position: absolute
    inset: 6px
    border-radius: calc(var(--radius-md) - 6px)
    box-shadow: inset 0 2px 0 var(--bevel-light), inset 0 -2px 0 rgba(0,0,0,0.55)
    pointer-events: none
    z-index: 1

// Cards & Panels: Panel inner content
panel-inner()
  background: radial-gradient(120% 120% at 20% 10%, rgba(255,255,255,0.30), transparent), linear-gradient(180deg, var(--parchment-200), var(--parchment-400))
  color: var(--text-ink)
  border-radius: var(--radius-sm)
  padding: var(--space-4)
  box-shadow: inset 0 2px 0 rgba(255,255,255,0.25), inset 0 -3px 0 rgba(0,0,0,0.25)
  position: relative
  z-index: 2

// Modals: Base modal overlay
modal-base()
  position: fixed
  top: 0
  left: 0
  width: 100%
  height: 100%
  background-color: rgba(0, 0, 0, 0.6)
  display: none
  align-items: center
  justify-content: center
  z-index: var(--z-modal)
  padding: var(--space-4)
  box-sizing: border-box

// Modals: Modal content container
modal-content(max-width = 500px)
  background: linear-gradient(180deg, var(--wood-600), var(--wood-800))
  border-radius: var(--radius-lg)
  box-shadow: 0 10px 30px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.2)
  border: 1px solid rgba(0,0,0,0.6)
  max-width: max-width
  width: 90%
  max-height: 90vh
  overflow: hidden
  position: relative
  z-index: calc(var(--z-modal) + 1)
  pointer-events: auto
  display: flex
  flex-direction: column

// Modals: Modal header
modal-header()
  background: linear-gradient(180deg, var(--wood-600), var(--wood-800))
  border-bottom: 3px solid var(--brass-500)
  padding: var(--space-6) var(--space-7)
  box-shadow: 0 2px 8px rgba(0,0,0,0.2)
  position: relative
  z-index: 5

// Modals: Modal body
modal-body()
  padding: var(--space-6)
  background: var(--parchment-200)
  max-height: 70vh
  overflow-y: auto

// Modals: Modal footer
modal-footer()
  background: linear-gradient(180deg, var(--wood-600), var(--wood-800))
  border-top: 3px solid var(--brass-500)
  padding: var(--space-5) var(--space-6)
  display: flex
  align-items: center
  justify-content: space-between
  gap: var(--space-3)

// Badges: Base badge
badge-base()
  display: inline-block
  padding: var(--space-1) var(--space-2)
  border-radius: var(--radius-sm)
  font-size: 0.75rem
  font-weight: 600
  text-transform: uppercase
  letter-spacing: 0.05em

// Badges: Pill-shaped badge
badge-pill()
  border-radius: 999px
  padding: var(--space-1) var(--space-3)

// Badges: Badge variant
badge-variant(type = 'primary')
  if type == 'primary'
    background: linear-gradient(180deg, var(--brass-300), var(--brass-500))
    color: var(--wood-900)
    border: 1px solid var(--brass-600)
  else if type == 'secondary'
    background: linear-gradient(180deg, var(--parchment-200), var(--parchment-400))
    color: var(--wood-900)
    border: 1px solid var(--parchment-600)
  else if type == 'success'
    background: linear-gradient(180deg, var(--green-crt), var(--green-crt-dim))
    color: var(--wood-900)
    border: 1px solid var(--green-crt-dim)
  else if type == 'warning'
    background: linear-gradient(180deg, var(--brass-300), var(--brass-500))
    color: var(--wood-900)
    border: 1px solid var(--brass-600)

// Tooltips: Base tooltip
tooltip-base()
  position: relative
  
  &::after
    content: attr(data-tooltip)
    position: absolute
    bottom: 100%
    left: 50%
    transform: translateX(-50%)
    padding: var(--space-2) var(--space-3)
    background: var(--wood-900)
    color: var(--text-strong)
    border-radius: var(--radius-sm)
    font-size: 0.875rem
    white-space: nowrap
    opacity: 0
    pointer-events: none
    transition: opacity var(--t-fast) var(--ease)
    z-index: 1000
    margin-bottom: var(--space-1)
  
  &:hover::after
    opacity: 1

// Tooltips: Tooltip arrow
tooltip-arrow(position = 'top')
  &::before
    content: ""
    position: absolute
    if position == 'top'
      bottom: 100%
      left: 50%
      transform: translateX(-50%)
      border: 6px solid transparent
      border-top-color: var(--wood-900)
    else if position == 'bottom'
      top: 100%
      left: 50%
      transform: translateX(-50%)
      border: 6px solid transparent
      border-bottom-color: var(--wood-900)
    else if position == 'left'
      right: 100%
      top: 50%
      transform: translateY(-50%)
      border: 6px solid transparent
      border-left-color: var(--wood-900)
    else if position == 'right'
      left: 100%
      top: 50%
      transform: translateY(-50%)
      border: 6px solid transparent
      border-right-color: var(--wood-900)

// Dropdowns: Base dropdown
dropdown-base()
  position: relative
  display: inline-block

// Dropdowns: Dropdown menu
dropdown-menu()
  position: absolute
  top: 100%
  right: 0
  margin-top: var(--space-2)
  background: linear-gradient(180deg, var(--parchment-200), var(--parchment-400))
  color: var(--text-ink)
  border-radius: var(--radius-md)
  box-shadow: 0 10px 30px rgba(0,0,0,0.5)
  padding: var(--space-2)
  min-width: 150px
  display: none
  border: 1px solid rgba(0,0,0,0.3)
  z-index: 1000

// Dropdowns: Dropdown item
dropdown-item()
  display: block
  padding: var(--space-2) var(--space-3)
  color: var(--text-ink)
  text-decoration: none
  border-radius: var(--radius-sm)
  transition: color var(--t-fast) var(--ease)
  display: flex
  flex-direction: row
  align-items: center
  justify-content: flex-start
  gap: var(--space-2)

  &:hover
    background-color: var(--parchment-100)

// Navigation: Base navigation
nav-base()
  display: flex
  list-style: none
  gap: var(--space-2)
  margin: 0
  padding: 0

// Navigation: Navigation link
nav-link-base()
  color: var(--text-soft)
  text-decoration: none
  padding: var(--space-2) var(--space-3)
  border-radius: var(--radius-md)
  transition-all()
  font-weight: 500
  position: relative

  &:hover
    background-color: rgba(202, 162, 74, 0.15)
    color: var(--text-strong)
    transform: translateY(-1px)

// Navigation: Active nav link
nav-link-active()
  background: linear-gradient(180deg, var(--parchment-300), var(--parchment-500))
  color: var(--wood-900)
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.5)

// Progress: Progress bar container
progress-bar-base(height = 16px, bg = var(--wood-700))
  width: 100%
  height: height
  border-radius: 10px
  background: linear-gradient(180deg, bg, var(--wood-900))
  box-shadow: inset 0 2px 0 rgba(255,255,255,0.15), inset 0 -2px 0 rgba(0,0,0,0.55)
  overflow: hidden

// Progress: Progress fill
progress-bar-fill(color = var(--brass-500), duration = 0.6s)
  height: 100%
  background: linear-gradient(90deg, var(--brass-300), var(--brass-500), var(--brass-600))
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.3), 0 0 8px rgba(156, 124, 56, 0.4)
  transition: width duration var(--ease)

// Progress: Animated progress bar
progress-bar-animated()
  background: linear-gradient(90deg, var(--brass-300), var(--brass-500), var(--brass-600))
  background-size: 200% 100%
  animation: progress-shimmer 2s linear infinite

// Loading: Base spinner
loading-spinner-base()
  text-align: center
  color: var(--text-strong)

  i
    animation-spin(2s)

// Loading: Spinner size variants
loading-spinner-size(size = 'md')
  if size == 'sm'
    font-size: 1.5rem
  else if size == 'md'
    font-size: 3rem
  else if size == 'lg'
    font-size: 4rem

// ==========================================================================
// Form Element Mixins
// ==========================================================================

// Form group container
form-group()
  margin-bottom: var(--space-4)

// Form label styling
form-label()
  display: block
  margin-bottom: var(--space-2)
  color: var(--wood-800)
  font-weight: 600
  font-family: 'Lora', Georgia, 'Times New Roman', serif

// Form help text
form-help()
  display: block
  margin-top: var(--space-1)
  font-size: 0.875rem
  color: var(--wood-700)
  font-style: italic

// Form error message
form-error-message()
  display: block
  margin-top: var(--space-1)
  font-size: 0.875rem
  color: var(--red-500)
  font-weight: 600

// Checkbox base styling
checkbox-base()
  display: inline-flex
  align-items: center
  gap: 10px
  cursor: pointer
  user-select: none
  color: var(--text-ink)

  input
    position: absolute
    opacity: 0
    pointer-events: none

  .box
    width: 20px
    height: 20px
    border-radius: 6px
    background: linear-gradient(180deg, var(--parchment-200), var(--parchment-500))
    border: 1px solid rgba(0,0,0,0.35)
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.6), inset 0 -1px 0 rgba(0,0,0,0.25)
    position: relative
    flex-shrink: 0

  input:checked + .box::after
    content: "âœ“"
    position: absolute
    inset: 0
    display: grid
    place-items: center
    color: var(--wood-900)
    font-weight: 700
    font-size: 16px

  &:hover .box
    border-color: var(--brass-500)

// Radio button base styling
radio-base()
  display: inline-flex
  align-items: center
  gap: 10px
  cursor: pointer
  user-select: none
  color: var(--text-ink)

  input
    position: absolute
    opacity: 0
    pointer-events: none

  .dot
    width: 20px
    height: 20px
    border-radius: 50%
    background: linear-gradient(180deg, var(--parchment-200), var(--parchment-500))
    border: 1px solid rgba(0,0,0,0.35)
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.6), inset 0 -1px 0 rgba(0,0,0,0.25)
    position: relative
    flex-shrink: 0

  input:checked + .dot::after
    content: ""
    position: absolute
    width: 10px
    height: 10px
    border-radius: 50%
    background: radial-gradient(circle at 30% 30%, var(--brass-300), var(--brass-600))
    top: 50%
    left: 50%
    transform: translate(-50%, -50%)

  &:hover .dot
    border-color: var(--brass-500)

// Switch/toggle base styling
switch-base()
  --w: 56px
  --h: 28px
  position: relative
  width: var(--w)
  height: var(--h)
  background: linear-gradient(180deg, var(--wood-600), var(--wood-800))
  border-radius: var(--h)
  box-shadow: var(--shadow-wood)
  border: 1px solid rgba(0,0,0,0.5)
  cursor: pointer

  &__thumb
    position: absolute
    top: 3px
    left: 3px
    width: 22px
    height: 22px
    border-radius: 50%
    background: radial-gradient(circle at 35% 30%, var(--parchment-300), var(--parchment-600))
    transition: left var(--t-med) var(--ease)
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.65), inset 0 -1px 0 rgba(0,0,0,0.25)

  &[data-state="on"] &__thumb
    left: calc(var(--w) - 25px)

  &:focus-visible
    focus-ring()

// Slider/range input base styling
slider-base()
  width: 100%
  height: 8px
  background: rgba(0,0,0,0.35)
  border-radius: 999px
  position: relative

  &__fill
    position: absolute
    height: 100%
    background: linear-gradient(90deg, var(--brass-400), var(--brass-300))
    border-radius: inherit

  &__thumb
    position: absolute
    top: 50%
    transform: translate(-50%, -50%)
    width: 18px
    height: 18px
    border-radius: 50%
    background: radial-gradient(circle at 35% 30%, var(--parchment-300), var(--parchment-600))
    border: 1px solid rgba(0,0,0,0.5)
    box-shadow: var(--shadow-wood)
    cursor: pointer

// Form row layout
form-row()
  grid-auto-fit(200px, var(--space-4))
  margin-bottom: var(--space-4)

// ==========================================================================
// Utility Mixins
// ==========================================================================

// Scrollbar: Custom scrollbar
scrollbar-custom(track-color = var(--wood-700), thumb-color = var(--brass-500))
  &::-webkit-scrollbar
    width: 12px

  &::-webkit-scrollbar-track
    background: track-color
    border-radius: 6px

  &::-webkit-scrollbar-thumb
    background: linear-gradient(180deg, thumb-color, var(--brass-600))
    border-radius: 6px
    border: 2px solid track-color

    &:hover
      background: linear-gradient(180deg, var(--brass-500), var(--brass-700))

// Image: Base image styling
image-base()
  max-width: 100%
  height: auto
  display: block

// Image: Rounded image
image-rounded()
  border-radius: var(--radius-md)

// Image: Responsive image
image-responsive()
  max-width: 100%
  height: auto
  display: block
  object-fit: contain

// Code: Inline code
code-base()
  font-family: "VT323", monospace
  font-size: 0.9em
  background: var(--wood-800)
  color: var(--brass-300)
  padding: 2px 4px
  border-radius: 3px

// Code: Code block (pre)
code-block()
  font-family: "VT323", monospace
  font-size: 0.9rem
  background: var(--wood-800)
  color: var(--brass-300)
  padding: var(--space-3)
  border-radius: var(--radius-sm)
  overflow-x: auto
  display: block
  margin: var(--space-4) 0

// Misc: Text truncation
truncate()
  overflow: hidden
  text-overflow: ellipsis
  white-space: nowrap

// Misc: Screen reader only
sr-only()
  position: absolute
  width: 1px
  height: 1px
  padding: 0
  margin: -1px
  overflow: hidden
  clip: rect(0, 0, 0, 0)
  white-space: nowrap
  border-width: 0

// ==========================================================================
// Keyframe Animations
// ==========================================================================

@keyframes slide-in
  from
    opacity: 0
    transform: translateY(20px)
  to
    opacity: 1
    transform: translateY(0)

@keyframes fade
  from
    opacity: 0
  to
    opacity: 1

@keyframes spin
  from
    transform: rotate(0deg)
  to
    transform: rotate(360deg)

@keyframes pulse
  0%, 100%
    opacity: 1
  50%
    opacity: 0.5

@keyframes progress-shimmer
  0%
    background-position: 200% 0
  100%
    background-position: -200% 0
